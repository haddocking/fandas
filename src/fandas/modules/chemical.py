from pathlib import Path
import os
import logging

log = logging.getLogger("fandaslog")

STANDARD_DATA = Path(Path(__file__).parents[1], "data/standard.csv")

amino_acids = [
    "A",
    "R",
    "D",
    "N",
    "C",
    "E",
    "Q",
    "G",
    "H",
    "I",
    "L",
    "K",
    "M",
    "F",
    "P",
    "S",
    "T",
    "W",
    "Y",
    "V",
]

secondary_structures = [
    "a",
    "b",
    "c",
    "n",
]  # a=alpha helix, b=beta sheet, c=random coil, n=bmrb collected average

ATOM_LIST = open(STANDARD_DATA).readlines()[0].split(os.linesep)[0].split(",")[2:]

ATOM_REF = {
    "C0": "C",
    "CO": "C",
    "CACX": [atom for atom in ATOM_LIST if "C" in atom and "CA" not in atom],
    "COCX": [atom for atom in ATOM_LIST if "C" in atom and "C" not in atom],
    "CA+CB": [atom for atom in ATOM_LIST if atom in ["CA", "CB"]],
    "NH": "H",
}

# This tells the position of each atom in the chemical shift:
#  ex:
# ATOM_INDEXES['HB2']
#  > 5
ATOM_INDEX_DIC = dict((atom, i) for i, atom in enumerate(ATOM_LIST))

atom_type = [
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "N",
    "N",
    "N",
    "N",
    "N",
    "N",
    "N",
    "N",
    "N",
    "C",
    "C",
    "C",
    "C",
    "C",
    "C",
    "C",
    "C",
    "C",
    "C",
    "C",
    "C",
    "C",
    "C",
    "C",
    "C",
    "C",
]

atom_positions = [
    "N",
    "A",
    "A2",
    "A3",
    "B",
    "B2",
    "B3",
    "G1",
    "G2",
    "G2",
    "G2",
    "G3",
    "D",
    "D1",
    "D2",
    "D2",
    "D2",
    "D3",
    "E",
    "E1",
    "E1",
    "E1",
    "E2",
    "E3",
    "H",
    "H1",
    "H1",
    "H2",
    "H2",
    "H2",
    "Z",
    "Z2",
    "Z3",
    "N",
    "G1",
    "G2",
    "D",
    "D1",
    "D2",
    "H1",
    "H2",
    "Z",
    "C",
    "A",
    "B",
    "G",
    "G1",
    "G2",
    "D",
    "D1",
    "D2",
    "D3",
    "E",
    "E1",
    "E2",
    "H2",
    "Z",
    "Z2",
    "Z3",
]

simple_atom_positions = [
    "N",
    "A",
    "A",
    "A",
    "B",
    "B",
    "B",
    "G",
    "G",
    "G",
    "G",
    "G",
    "D",
    "D",
    "D",
    "D",
    "D",
    "D",
    "E",
    "E",
    "E",
    "E",
    "E",
    "E",
    "H",
    "H",
    "H",
    "H",
    "H",
    "H",
    "Z",
    "Z",
    "Z",
    "N",
    "G",
    "G",
    "D",
    "D",
    "D",
    "H",
    "H",
    "Z",
    "C",
    "A",
    "B",
    "G",
    "G",
    "G",
    "D",
    "D",
    "D",
    "D",
    "E",
    "E",
    "E",
    "H",
    "Z",
    "Z",
    "Z",
]

H_ATOMS = [
    "H",
    "HA",
    "HA2",
    "HA3",
    "HB",
    "HB2",
    "HB3",
    "HG1",
    "HG2",
    "HG21",
    "HG22",
    "HG3",
    "HD",
    "HD1",
    "HD2",
    "HD21",
    "HD22",
    "HD3",
    "HE",
    "HE1",
    "HE12",
    "HE13",
    "HE2",
    "HE3",
    "HH",
    "HH11",
    "HH12",
    "HH2",
    "HH21",
    "HH22",
    "HZ",
    "HZ2",
    "HZ3",
]
h_atm_ind = [
    0,
    1,
    2,
    3,
    4,
    5,
    6,
    7,
    8,
    9,
    10,
    11,
    12,
    13,
    14,
    15,
    16,
    17,
    18,
    19,
    20,
    21,
    22,
    23,
    24,
    25,
    26,
    27,
    28,
    29,
    30,
    31,
    32,
]

N_ATOMS = ["N", "NG1", "NG2", "ND", "ND1", "ND2", "NH1", "NH2", "NZ"]
n_atm_ind = [33, 34, 35, 36, 37, 38, 39, 40, 41]


C_ATOMS = [
    "C",
    "CA",
    "CB",
    "CG",
    "CG1",
    "CG2",
    "CD",
    "CD1",
    "CD2",
    "CD3",
    "CE",
    "CE1",
    "CE2",
    "CH2",
    "CZ",
    "CZ2",
    "CZ3",
]
c_atm_ind = [42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58]

list_2d = [
    "NH",
    "HN",
    "CH",
    "HC",
    "HH",
    "DQSQ",
    "CC_SPINDIFF_INTRA",
    "CC_SPINDIFF_INTER",
    "NCA",
    "NCO",
    "NCACX",
    "NCACX_INTER",
    "NCOCX",
    "NCOCA_CB",
    "CANH",
    "CONH",
    "CACONH",
    "COCANH",
    "NCAH",
]

list_3d = [
    "NCACX",
    "NCACX_INTER",
    "NCOCX",
    "NCOCA_CB",
    "SQSQSQ_INTER",
    "DQSQSQ_INTRA",
    "DQSQSQ_INTER",
    "CANH",
    "CONH",
    "CACONH",
    "COCANH",
    "NCAH",
]

list_2dd = ["CC_SPINDIFF", "HH", "CHHC", "NHHC", "CHH", "NHH", "HHC", "NCACX", "NCOCX"]

list_3dd = ["CHH", "NHH", "NCACX", "NCOCX"]

# Atoms to be removed from each aminoacid based on 1,3-13C-glycerol labeling
#  all atoms present on standard.csv are represented here, even if non existent
#  such as CG1 for ALA
GL_13 = {
    "A": [
        "CA",
        "CG1",
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "R": [
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "D": [
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "N": [
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "C": [
        "CA",
        "CG1",
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "E": [
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "Q": [
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "G": [
        "CA",
        "CB",
        "CG1",
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "H": [
        "CA",
        "CG2",
        "CD1",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "I": ["CB", "CD2", "CE1", "CE2", "CE3", "CZ1", "CZ2", "CZ3", "CH"],
    "L": [
        "C",
        "CB",
        "CG1",
        "CG2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "K": ["CG2", "CD2", "CE2", "CE3", "CZ1", "CZ2", "CZ3", "CH"],
    "M": ["CG2", "CD1", "CD2", "CE2", "CE3", "CZ1", "CZ2", "CZ3", "CH"],
    "F": ["CA", "CG1", "CG2", "CE2", "CE3", "CZ2", "CZ3", "CH"],
    "P": [
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "S": [
        "CA",
        "CG1",
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "T": [
        "CG1",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "W": ["CA", "CG2", "CD2", "CE1", "CZ1", "CZ3"],
    "Y": ["CA", "CG1", "CG2", "CE2", "CE3", "CZ2", "CZ3", "CH"],
    "V": [
        "CA",
        "CB",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
}

AA_REF = {
    "A": "ALA",
    "R": "ARG",
    "D": "ASP",
    "N": "ASN",
    "C": "CYS",
    "E": "GLU",
    "Q": "GLN",
    "G": "GLY",
    "H": "HIS",
    "I": "ILE",
    "L": "LEU",
    "K": "LYS",
    "M": "MET",
    "F": "PHE",
    "P": "PRO",
    "S": "SER",
    "T": "THR",
    "W": "TRP",
    "Y": "TYR",
    "V": "VAL",
}

SS_REF = {"n": "COIL", "a": "ALPHA", "b": "BETA", "c": "COIL"}

GL_2 = {
    "A": [
        "C",
        "CB",
        "CG1",
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "R": [
        "CG1",
        "CG2",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "D": [
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "N": [
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "C": [
        "C",
        "CB",
        "CG1",
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "E": [
        "CG1",
        "CG2",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "Q": [
        "CG1",
        "CG2",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "G": [
        "C",
        "CB",
        "CG1",
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "H": [
        "C",
        "CB",
        "CG2",
        "CD1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "I": ["CG2", "CD2", "CE1", "CE2", "CE3", "CZ1", "CZ2", "CZ3", "CH"],
    "L": [
        "CA",
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "K": ["CG2", "CD2", "CE2", "CE3", "CZ1", "CZ2", "CZ3", "CH"],
    "M": [
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "F": [
        "C",
        "CB",
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "P": [
        "CG1",
        "CG2",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "S": [
        "C",
        "CB",
        "CG1",
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "T": [
        "CG1",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "W": [
        "C",
        "CB",
        "CG2",
        "CD1",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CH",
    ],
    "Y": [
        "C",
        "CB",
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
    "V": [
        "C",
        "CG1",
        "CG2",
        "CD1",
        "CD2",
        "CE1",
        "CE2",
        "CE3",
        "CZ1",
        "CZ2",
        "CZ3",
        "CH",
    ],
}

DEUTERATION = {
    "A": ["HA"],
    "R": ["HA", "HB"],
    "D": ["HA"],
    "N": ["HA"],
    "C": ["HA"],
    "E": ["HA", "HB"],
    "Q": ["HA", "HB"],
    "G": ["HA"],
    "H": ["HA"],
    "I": ["HA", "HB", "HG"],
    "K": ["HA"],
    "M": ["HA"],
    "P": ["HA", "HB"],
    "L": ["HA", "HB", "HG"],
    "F": ["HA"],
    "S": ["HA"],
    "T": ["HA"],
    "W": ["HA"],
    "Y": ["HA"],
    "V": ["HA", "HB"],
}
